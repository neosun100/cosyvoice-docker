# CosyVoice3 Benchmark Report

> 测试时间: 2026-01-18  
> 测试环境: NVIDIA L40S (48GB VRAM)  
> 模型: Fun-CosyVoice3-0.5B  
> 测试音色: 太乙真人 (12.88秒参考音频)

---

## 📊 1. 文本长度性能测试

| 文本类型 | 字数 | TTFB | 总时间 | 音频时长 | RTF | 状态 |
|---------|------|------|--------|---------|-----|------|
| 短文本 | 10 | 1.86s | 3.62s | 3.92s | 0.92 | ✅ |
| 中文本 | 41 | 1.06s | 11.68s | 14.28s | 0.82 | ✅ |
| 长文本 | 81 | 1.11s | 17.85s | 20.84s | 0.86 | ✅ |
| 很长文本 | 142 | 1.14s | 41.77s | 46.32s | 0.90 | ✅ |
| 超长文本 | 294 | 1.16s | 72.89s | 83.64s | 0.87 | ✅ |

### 关键指标
- **平均 TTFB**: 1.27s (首字节延迟稳定)
- **平均 RTF**: 0.87 (实时因子 < 1)
- **结论**: RTF < 1 表示生成速度快于播放速度，不会出现卡顿

### RTF 说明
- RTF (Real-Time Factor) = 生成时间 / 音频时长
- RTF < 1: 生成速度快于播放，可实时播放
- RTF > 1: 生成速度慢于播放，会出现卡顿

---

## 📊 2. 流式 vs 非流式对比

| 模式 | TTFB | 总时间 | RTF |
|------|------|--------|-----|
| 流式 | 1.01s | 10.67s | 0.79 |
| 非流式 | 7.45s | 7.45s | 0.51 |

### 分析
- **流式模式 TTFB 降低 86%** (1.01s vs 7.45s)
- 流式模式总时间略长，但用户体验更好
- **推荐**: 实时交互场景使用流式模式

---

## 📊 3. 三种合成模式测试

### 3.1 零样本克隆 (zero_shot)
最常用的模式，使用参考音频克隆任意音色。

```bash
curl -X POST http://localhost:8188/api/tts \
  -F "text=你好，这是测试文本。" \
  -F "voice=d0f44e420c02" \
  -F "mode=zero_shot" \
  -F "stream=1"
```

| 特点 | 说明 |
|------|------|
| 输入 | 文本 + 参考音频 + 参考文本 |
| 输出 | 克隆音色的语音 |
| 适用 | 通用语音合成 |

### 3.2 跨语种合成 (cross_lingual)
使用中文音色合成其他语言，保持音色特征。

```bash
curl -X POST http://localhost:8188/api/tts \
  -F "text=Hello, welcome to Beijing." \
  -F "voice=d0f44e420c02" \
  -F "mode=cross_lingual" \
  -F "stream=1"
```

| 语言 | TTFB | 总时间 | 音频时长 | 状态 |
|------|------|--------|---------|------|
| 英文 | 1.21s | 7.40s | 9.32s | ✅ |
| 日文 | 1.10s | 4.52s | 6.16s | ✅ |
| 中英混合 | 1.11s | 6.68s | 8.52s | ✅ |

### 3.3 指令控制 (instruct)
通过指令控制方言、情感、语速等。

```bash
curl -X POST http://localhost:8188/api/tts \
  -F "text=你好，欢迎来到成都。" \
  -F "voice=d0f44e420c02" \
  -F "mode=instruct" \
  -F "instruct_text=用四川话说这句话" \
  -F "stream=1"
```

| 指令类型 | TTFB | 总时间 | 音频时长 | 状态 |
|---------|------|--------|---------|------|
| 四川话 | 1.24s | 6.56s | 8.36s | ✅ |
| 粤语 | 1.20s | 3.65s | 4.32s | ✅ |
| 东北话 | 1.21s | 5.29s | 6.36s | ✅ |
| 开心语气 | 1.28s | 4.67s | 5.36s | ✅ |
| 悲伤语气 | 1.22s | 5.93s | 8.00s | ✅ |

---

## 📊 4. API 功能测试

| API | 端点 | 状态 |
|-----|------|------|
| 健康检查 | GET /health | ✅ |
| 音色列表 | GET /v1/voices | ✅ |
| 自定义音色 | GET /v1/voices/custom | ✅ |
| 模型列表 | GET /v1/models | ✅ |
| API 文档 | GET /docs | ✅ |
| OpenAPI | GET /openapi.json | ✅ |

---

## 📈 最佳实践

### 1. 选择合适的模式
| 场景 | 推荐模式 |
|------|---------|
| 通用语音合成 | zero_shot |
| 多语言内容 | cross_lingual |
| 方言/情感控制 | instruct |

### 2. 流式 vs 非流式
| 场景 | 推荐 |
|------|------|
| 实时对话 | 流式 (低延迟) |
| 批量生成 | 非流式 (高效率) |
| 长文本 | 流式 (边生成边播放) |

### 3. 文本长度建议
- **短文本 (<50字)**: 适合实时交互
- **中文本 (50-100字)**: 适合段落朗读
- **长文本 (>100字)**: 建议分段处理

### 4. 参考音频要求
- **时长**: 3-30秒 (推荐 5-15秒)
- **质量**: 清晰、无噪音
- **内容**: 与参考文本匹配

---

## 🔧 性能优化建议

1. **使用流式模式**: TTFB 降低 86%
2. **预热音色缓存**: 首次使用后速度提升 53%
3. **合理分段**: 超长文本建议分段处理
4. **GPU 显存**: 建议 8GB+ VRAM

---

## 📁 测试音频

所有测试音频已保存到 `/tmp/benchmark_results/`:
- `len_*.wav` - 不同长度文本测试
- `stream_*.wav` - 流式/非流式对比
- `cross_*.wav` - 跨语种测试
- `inst_*.wav` - 指令控制测试

---

*Generated by CosyVoice3 Benchmark Tool*
